{"ast":null,"code":"import _defineProperty from \"/Users/paulbickell/Documents/React/react-dtt-ideas-v1/react-dtt-demo-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/paulbickell/Documents/React/react-dtt-ideas-v1/react-dtt-demo-app/src/common/form.jsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from \"react\";\nimport Joi from \"joi\";\nimport Input from \"./input\";\nimport Select from \"./select\";\nimport TextArea from \"./textArea\";\n\nclass Form extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      data: {},\n      errors: {}\n    };\n\n    this.validateWithJoi = () => {\n      // params:  binding object, validation definition\n      const option = {\n        abortEarly: false\n      }; // ie do not terminate validation as soon as Joi finds an error\n\n      const result = Joi.validate(this.state.data, this.schema, option);\n      if (!result.error) return null; // no Joi error\n\n      const errors = {};\n\n      for (let item of result.error.details) {\n        errors[item.path] = item.message; // creates an errors map / array of different paths (ie. property names)\n      }\n\n      return errors;\n    };\n\n    this.validateProperty = ({\n      name,\n      value\n    }) => {\n      const obj = {\n        [name]: value\n      }; // name of input property supplied dynamically\n\n      const schema = {\n        [name]: this.schema[name]\n      }; // note we want to abort early, so as not to display all errors at once\n\n      const _Joi$validate = Joi.validate(obj, schema),\n            error = _Joi$validate.error; // if there is an error on this input component, return the first error details string\n\n\n      return error ? error.details[0].message : null;\n    };\n\n    this.handleChange = ({\n      currentTarget: input\n    }) => {\n      const errors = _objectSpread({}, this.state.errors);\n\n      const errorMsg = this.validateProperty(input);\n      if (errorMsg) errors[input.name] = errorMsg;else delete errors[input.name];\n\n      const data = _objectSpread({}, this.state.data);\n\n      data[input.name] = input.value;\n      this.setState({\n        data,\n        errors\n      });\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n      const errors = this.validateWithJoi();\n      this.setState({\n        errors: errors || {}\n      });\n      if (errors) return;\n      this.doSubmit();\n    };\n\n    this.renderButton = (label, classname = \"btn btn-primary\") => {\n      return React.createElement(\"button\", {\n        disabled: this.validateWithJoi(),\n        className: classname,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63\n        },\n        __self: this\n      }, label);\n    };\n\n    this.renderInput = (propName, label, autoFocus, width, type = \"text\") => {\n      const _this$state = this.state,\n            data = _this$state.data,\n            errors = _this$state.errors;\n      return React.createElement(Input, {\n        type: type,\n        name: propName,\n        label: label,\n        width: width,\n        value: data[propName] //  value={data.propName}\n        ,\n        onChange: this.handleChange,\n        error: errors[propName] // error={errors.username}\n        ,\n        autoFocus: autoFocus,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72\n        },\n        __self: this\n      });\n    };\n\n    this.renderReadOnlyTextArea = (propName, label, autoFocus, width, rows, value) => {\n      const _this$state2 = this.state,\n            data = _this$state2.data,\n            errors = _this$state2.errors;\n      return React.createElement(TextArea, {\n        name: propName,\n        label: label,\n        onChange: this.handleChange,\n        autoFocus: autoFocus,\n        width: width,\n        rows: rows,\n        value: value,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      });\n    };\n\n    this.renderSelect = (propName, label, autoFocus, options, width) => {\n      const _this$state3 = this.state,\n            data = _this$state3.data,\n            errors = _this$state3.errors; // console.log(\"propname \" + propName + \": \", data[propName]);\n\n      return React.createElement(Select, {\n        name: propName,\n        width: width,\n        label: label,\n        value: data[propName] //  value={data.propName}\n        ,\n        autoFocus: autoFocus,\n        options: options,\n        error: errors[propName] // error={errors.username}\n        ,\n        onChange: this.handleChange // KEY: hook into this onChange event handler\n        ,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      });\n    };\n  }\n\n} // note there is no render method because this component is for validation only\n\n\nexport default Form;","map":{"version":3,"sources":["/Users/paulbickell/Documents/React/react-dtt-ideas-v1/react-dtt-demo-app/src/common/form.jsx"],"names":["React","Component","Joi","Input","Select","TextArea","Form","state","data","errors","validateWithJoi","option","abortEarly","result","validate","schema","error","item","details","path","message","validateProperty","name","value","obj","handleChange","currentTarget","input","errorMsg","setState","handleSubmit","e","preventDefault","doSubmit","renderButton","label","classname","renderInput","propName","autoFocus","width","type","renderReadOnlyTextArea","rows","renderSelect","options"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Joi from \"joi\";\nimport Input from \"./input\";\nimport Select from \"./select\";\nimport TextArea from \"./textArea\";\n\nclass Form extends Component {\n  state = {\n    data: {},\n    errors: {}\n  };\n  \n  validateWithJoi = () => {\n    // params:  binding object, validation definition\n    const option = { abortEarly: false }; // ie do not terminate validation as soon as Joi finds an error\n    const result = Joi.validate(this.state.data, this.schema, option);\n\n    if (!result.error) return null; // no Joi error\n\n    const errors = {};\n    for (let item of result.error.details) {\n      errors[item.path] = item.message; // creates an errors map / array of different paths (ie. property names)\n    }\n\n    return errors;\n  };\n\n  validateProperty = ({ name, value }) => {\n    const obj = { [name]: value }; // name of input property supplied dynamically\n    const schema = { [name]: this.schema[name] };\n\n    // note we want to abort early, so as not to display all errors at once\n    const { error } = Joi.validate(obj, schema); \n    \n    // if there is an error on this input component, return the first error details string\n    return error ? error.details[0].message : null;\n  };\n\n  handleChange = ({ currentTarget: input }) => {\n    const errors = { ...this.state.errors };\n    const errorMsg = this.validateProperty(input);\n\n    if (errorMsg) errors[input.name] = errorMsg;\n    else delete errors[input.name];\n\n    const data = { ...this.state.data };\n    data[input.name] = input.value;\n    this.setState({ data, errors });\n  };\n\n  handleSubmit = e => {\n    e.preventDefault();\n    const errors = this.validateWithJoi();\n    this.setState({ errors: errors || {} });\n\n    if (errors) return;\n\n    this.doSubmit();\n  };\n\n  renderButton = (label, classname = \"btn btn-primary\") => {\n    return (\n      <button disabled={this.validateWithJoi()} className={classname}>\n        {label}\n      </button>\n    );\n  };\n\n  renderInput = (propName, label, autoFocus, width, type = \"text\") => {\n    const { data, errors } = this.state;\n    return (\n      <Input\n        type={type}\n        name={propName}\n        label={label}\n        width={width}\n        value={data[propName]} //  value={data.propName}\n        onChange={this.handleChange}\n        error={errors[propName]} // error={errors.username}\n        autoFocus={autoFocus}\n      />\n    );\n  };\n\n  renderReadOnlyTextArea = (propName, label, autoFocus, width, rows, value) => {\n    const { data, errors } = this.state;\n    return (\n      <TextArea\n        name={propName}\n        label={label}\n        onChange={this.handleChange}\n        autoFocus={autoFocus}\n        width={width}\n        rows={rows}\n        value={value}\n      />\n    );\n  };\n\n  renderSelect = (propName, label, autoFocus, options, width) => {\n    const { data, errors } = this.state;\n\n    // console.log(\"propname \" + propName + \": \", data[propName]);\n    return (\n      <Select\n        name={propName}\n        width={width}\n        label={label}\n        value={data[propName]} //  value={data.propName}\n        autoFocus={autoFocus}\n        options={options}\n        error={errors[propName]} // error={errors.username}\n        onChange={this.handleChange} // KEY: hook into this onChange event handler\n      />\n    );\n  };\n}\n// note there is no render method because this component is for validation only\n\nexport default Form;\n"]},"metadata":{},"sourceType":"module"}